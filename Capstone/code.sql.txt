/*Select all columns from the first 10 rows. What columns does the table have?*/SELECT *FROM surveyLIMIT 10; /*Examine the first five rows of each table*/SELECT *FROM quizLIMIT 5; SELECT *FROM home_try_onLIMIT 5; SELECT *FROM purchaseLIMIT 5; /*What is the number of responses for each question?*/SELECT question, count(distinct user_id) as 'responses'FROM surveyGROUP BY question; /*create a new table*/SELECT distinct q.user_id, h.user_id IS NOT NULL AS 'is_home_try_on', h.number_of_pairs, p.user_id IS NOT NULL AS 'is_purchase'FROM quiz AS 'q'LEFT JOIN home_try_on AS 'h'  ON q.user_id = h.user_idLEFT JOIN purchase AS 'p'  ON q.user_id = p.user_idLIMIT 10; /*We can calculate overall conversion rates by aggregating across all rows.*/WITH funnels AS (SELECT distinct q.user_id, h.user_id IS NOT NULL AS 'is_home_try_on', h.number_of_pairs, p.user_id IS NOT NULL AS 'is_purchase'FROM quiz AS 'q'LEFT JOIN home_try_on AS 'h'  ON q.user_id = h.user_idLEFT JOIN purchase AS 'p'  ON q.user_id = p.user_id)SELECT COUNT(*) AS 'num_quiz',   SUM(is_purchase) AS 'num_purchase',   1.0 * SUM(is_purchase) / COUNT(user_id) AS 'overall_conversion'FROM funnels; /*We can compare conversion from quiz?home_try_on and home_try_on?purchase*/WITH funnels AS (SELECT distinct q.user_id, h.user_id IS NOT NULL AS 'is_home_try_on', h.number_of_pairs, p.user_id IS NOT NULL AS 'is_purchase'FROM quiz AS 'q'LEFT JOIN home_try_on AS 'h'  ON q.user_id = h.user_idLEFT JOIN purchase AS 'p'  ON q.user_id = p.user_id)SELECT COUNT(*) AS 'num_quiz',   SUM(is_home_try_on) AS 'num_try_on',   SUM(is_purchase) AS 'num_purchase',   1.0 * SUM(is_home_try_on) / COUNT(user_id) AS 'quiz_to_try_on',   1.0 * SUM(is_purchase) / SUM(is_home_try_on) AS 'try_on_to_purchase'FROM funnels; /*We can calculate the difference in purchase rates between customers who had 3 number_of_pairs with ones who had 5.*/WITH funnels AS (SELECT distinct q.user_id, h.user_id IS NOT NULL AS 'is_home_try_on', h.number_of_pairs, p.user_id IS NOT NULL AS 'is_purchase'FROM quiz AS 'q'LEFT JOIN home_try_on AS 'h'  ON q.user_id = h.user_idLEFT JOIN purchase AS 'p'  ON q.user_id = p.user_id)SELECT number_of_pairs, COUNT(*) AS 'num_quiz',   SUM(is_home_try_on) AS 'num_try_on',   SUM(is_purchase) AS 'num_purchase',   1.0 * SUM(is_home_try_on) / COUNT(user_id) AS 'quiz_to_try_on',   1.0 * SUM(is_purchase) / SUM(is_home_try_on) AS 'try_on_to_purchase'FROM funnelsGROUP BY number_of_pairsORDER BY number_of_pairs; /*The most common results of the style quiz.*/SELECT style, fit, color, count(*) as num_of_resultFROM quizGROUP BY style, fit, colorORDER BY style, num_of_result desc; /*The most common types of purchasemade.*/SELECT style, model_name, color, price, count(*) as total_purchaseFROM purchaseGROUP BY style, model_name, colorORDER BY style, total_purchase desc; SELECT style, model_name, count(*) as total_purchaseFROM purchaseGROUP BY style, model_nameORDER BY style, total_purchase desc; /*Price*/SELECT style, model_name, price, count(*)FROM purchaseGROUP BY style, model_name, priceORDER BY price desc; SELECT style, price, count(*) as total_purchaseFROM purchaseGROUP BY style, priceORDER BY style, total_purchase desc; /*Most Popular Color*/SELECT style, color, count(*) as total_purchaseFROM purchaseGROUP BY style, colorORDER BY style, total_purchase desc; /*Men's Women's Purchase*/SELECT style, count(*)FROM purchaseGROUP BY style; WITH funnels AS (SELECT distinct q.user_id, q.style as quiz_style, p.style as purchase_style, p.user_id IS NOT NULL AS 'is_purchase'FROM quiz AS 'q'LEFT JOIN purchase AS 'p'  ON q.user_id = p.user_id)SELECT quiz_style, purchase_style, COUNT(*) AS 'num_quiz',   SUM(is_purchase) AS 'num_purchase',   1.0 * SUM(is_purchase) / COUNT(user_id) AS 'percentage_purchase'FROM funnelsGROUP BY quiz_style, purchase_styleORDER BY quiz_style;